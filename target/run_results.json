{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2024-12-15T23:30:59.691594Z", "invocation_id": "2e85da29-8a3d-4b02-aa9e-6f7798aaab15", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-15T23:30:58.465083Z", "completed_at": "2024-12-15T23:30:58.473387Z"}, {"name": "execute", "started_at": "2024-12-15T23:30:58.497578Z", "completed_at": "2024-12-15T23:30:59.604470Z"}], "thread_id": "Thread-3", "execution_time": 1.1639044284820557, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "we-analysis", "job_id": "6afa548f-909f-4c26-b91e-e685ea301752", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.square_pipeline_project.dim_time", "compiled": true, "compiled_code": "-- Generate a range of timestamps for the time dimension\nWITH base_time AS (\n    SELECT \n        TIMESTAMP_ADD(\n            TIMESTAMP('1970-01-01'), \n            INTERVAL seq * 15 MINUTE\n        ) AS datetime\n    FROM \n        UNNEST(GENERATE_ARRAY(0, 525600, 1)) AS seq -- Adjust the range for desired time coverage\n),\ntime_components AS (\n    SELECT \n        datetime,\n        DATE(datetime) AS date,\n        EXTRACT(YEAR FROM datetime) AS year,\n        EXTRACT(QUARTER FROM datetime) AS quarter,\n        EXTRACT(MONTH FROM datetime) AS month,\n        FORMAT_TIMESTAMP('%B', datetime) AS month_name,\n        EXTRACT(WEEK FROM datetime) AS week,\n        EXTRACT(DAY FROM datetime) AS day,\n        FORMAT_TIMESTAMP('%A', datetime) AS day_name,\n        EXTRACT(DAYOFWEEK FROM datetime) AS day_of_week, -- 1 (Sunday) to 7 (Saturday)\n        EXTRACT(HOUR FROM datetime) AS hour,\n        EXTRACT(MINUTE FROM datetime) AS minute,\n        EXTRACT(SECOND FROM datetime) AS second,\n        CASE\n            WHEN EXTRACT(DAYOFWEEK FROM datetime) IN (1, 7) THEN TRUE\n            ELSE FALSE\n        END AS is_weekend\n    FROM \n        base_time\n)\nSELECT\n    *,\n    CONCAT(\n        CAST(year AS STRING), \n        '-', LPAD(CAST(month AS STRING), 2, '0'), \n        '-', LPAD(CAST(day AS STRING), 2, '0')\n    ) AS date_key -- Useful for joins\nFROM\n    time_components", "relation_name": "`we-analysis`.`Sales_Test`.`dim_time`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-15T23:30:58.468796Z", "completed_at": "2024-12-15T23:30:58.500446Z"}, {"name": "execute", "started_at": "2024-12-15T23:30:58.503378Z", "completed_at": "2024-12-15T23:30:59.665091Z"}], "thread_id": "Thread-2", "execution_time": 1.2252354621887207, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "we-analysis", "job_id": "9d7bc6fc-8d68-4944-9886-7a6053713c16", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.square_pipeline_project.dim_locations", "compiled": true, "compiled_code": "WITH location_data AS (\n    SELECT\n        DISTINCT location_id,\n        MAX(order_created_at) AS last_order_date,\n        COUNT(DISTINCT order_id) AS total_orders\n    FROM \n        `we-analysis`.`Sales_Test`.`stg_orders`\n    GROUP BY\n        location_id\n)\n\nSELECT \n    * \nFROM \n    location_data", "relation_name": "`we-analysis`.`Sales_Test`.`dim_locations`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-15T23:30:58.461563Z", "completed_at": "2024-12-15T23:30:58.488043Z"}, {"name": "execute", "started_at": "2024-12-15T23:30:58.500852Z", "completed_at": "2024-12-15T23:30:59.679011Z"}], "thread_id": "Thread-1", "execution_time": 1.2406010627746582, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "we-analysis", "job_id": "9b7b7411-fa33-439d-bd28-dc63273c7a6d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.square_pipeline_project.dim_items", "compiled": true, "compiled_code": "WITH item_data as (\n    SELECT \n        DISTINCT \n        item_name,\n        modifier_name,\n        base_price,\n        gross_sales\n    FROM \n        `we-analysis`.`Sales_Test`.`stg_line_items`\n)\n\nSELECT \n    *\nFROM \n    item_data", "relation_name": "`we-analysis`.`Sales_Test`.`dim_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-15T23:30:58.442858Z", "completed_at": "2024-12-15T23:30:58.471589Z"}, {"name": "execute", "started_at": "2024-12-15T23:30:58.473940Z", "completed_at": "2024-12-15T23:30:59.682215Z"}], "thread_id": "Thread-4", "execution_time": 1.2415249347686768, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "we-analysis", "job_id": "306623db-5314-41a5-bdcc-d5afcd8dcf06", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.square_pipeline_project.fact_sales", "compiled": true, "compiled_code": "WITH sales_data AS (\n    SELECT\n        o.order_id,\n        o.location_id,\n        o.order_created_at,\n        o.order_state,\n        o.total_amount AS revenue,\n        o.total_tax AS tax_amount,\n        o.total_tip AS tip_amount,\n        SUM(COALESCE(li.quantity, 0)) AS total_items_sold,\n        --Derived metrics\n        SAFE_DIVIDE(o.total_amount, SUM(COALESCE(li.quantity, 0))) AS average_order_value,\n        SAFE_DIVIDE(o.total_tax, o.total_amount) * 100 AS tax_percentage,\n        SAFE_DIVIDE(o.total_tip, o.total_amount) * 100 AS tip_percentage\n    FROM \n        `we-analysis`.`Sales_Test`.`int_order_items` li\n    JOIN \n        `we-analysis`.`Sales_Test`.`stg_orders` o\n    ON \n        li.order_id = o.order_id\n    WHERE\n        o.order_state = 'COMPLETED'\n    GROUP BY\n        o.order_id,\n        o.location_id,\n        o.order_created_at,\n        o.order_state,\n        o.total_amount, \n        o.total_tax,\n        o.total_tip\n)\n\nSELECT\n    *\nFROM \n    sales_data", "relation_name": "`we-analysis`.`Sales_Test`.`fact_sales`", "batch_results": null}], "elapsed_time": 3.020264148712158, "args": {"send_anonymous_usage_stats": true, "partial_parse": true, "select": ["facts_and_dimensions.*"], "use_colors": true, "which": "run", "write_json": true, "source_freshness_run_project_hooks": false, "exclude": [], "empty": false, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "populate_cache": true, "version_check": true, "log_level": "info", "print": true, "cache_selected_only": false, "profiles_dir": "/app/.dbt", "vars": {}, "show_resource_report": false, "introspect": true, "favor_state": false, "defer": false, "state_modified_compare_more_unrendered_values": false, "log_path": "/app/logs", "require_resource_names_without_spaces": false, "log_level_file": "debug", "strict_mode": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "project_dir": "/app", "log_format": "default", "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "quiet": false, "invocation_command": "dbt run --select facts_and_dimensions.*", "state_modified_compare_vars": false, "use_colors_file": true, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "printer_width": 80, "macro_debugging": false}}